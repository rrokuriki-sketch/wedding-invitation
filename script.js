// =========================== // Google Form Configuration // =========================== // TODO: Googleフォーム作成後、以下の値を設定してください // 1. Googleフォームを作成 // 2. フォームのプレビューページを開き、HTMLソースを表示 // 3. 各項目の name="entry.xxxxxxxx" の値をコピーして設定 const GOOGLE_FORM_CONFIG = { // フォームのAction URL（form要素のaction属性の値） formActionUrl: 'YOUR_GOOGLE_FORM_ACTION_URL', // 各項目のEntry ID entryIds: { name: 'entry.YOUR_NAME_ENTRY_ID', reception: 'entry.YOUR_RECEPTION_ENTRY_ID', party: 'entry.YOUR_PARTY_ENTRY_ID', guests: 'entry.YOUR_GUESTS_ENTRY_ID', message: 'entry.YOUR_MESSAGE_ENTRY_ID' } }; // =========================== // Smooth Scroll Navigation // =========================== document.addEventListener('DOMContentLoaded', () => { // Navigation link smooth scroll const navLinks = document.querySelectorAll('.nav-link'); navLinks.forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); const targetId = link.getAttribute('href'); const targetSection = document.querySelector(targetId); if (targetSection) { targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' }); } }); }); // Header background on scroll const header = document.getElementById('header'); window.addEventListener('scroll', () => { if (window.scrollY > 100) { header.classList.add('scrolled'); } else { header.classList.remove('scrolled'); } }); }); // =========================== // Scroll Animation // =========================== const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' }; const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); } }); }, observerOptions); // Observe sections for fade-in animation document.addEventListener('DOMContentLoaded', () => { const sections = document.querySelectorAll('.message, .info, .rsvp'); sections.forEach(section => { section.classList.add('fade-in'); observer.observe(section); }); }); // =========================== // RSVP Form Submission // =========================== document.addEventListener('DOMContentLoaded', () => { const rsvpForm = document.getElementById('rsvpForm'); const thankYouMessage = document.getElementById('thankYou'); if (rsvpForm) { rsvpForm.addEventListener('submit', async (e) => { e.preventDefault(); // Get form data const formData = new FormData(rsvpForm); const name = formData.get('name'); const reception = formData.get('reception'); const party = formData.get('party'); const guests = formData.get('guests') || '0'; const message = formData.get('message') || ''; // Validate required fields if (!name || !reception || !party) { alert('お名前と出欠のご回答は必須項目です。'); return; } // Prepare data for Google Form const googleFormData = new FormData(); googleFormData.append(GOOGLE_FORM_CONFIG.entryIds.name, name); googleFormData.append(GOOGLE_FORM_CONFIG.entryIds.reception, reception); googleFormData.append(GOOGLE_FORM_CONFIG.entryIds.party, party); googleFormData.append(GOOGLE_FORM_CONFIG.entryIds.guests, guests); googleFormData.append(GOOGLE_FORM_CONFIG.entryIds.message, message); try { // Submit to Google Form // Note: Using 'no-cors' mode to avoid CORS issues // The request will succeed but we won't get a response await fetch(GOOGLE_FORM_CONFIG.formActionUrl, { method: 'POST', body: googleFormData, mode: 'no-cors' }); // Hide form and show thank you message rsvpForm.style.display = 'none'; thankYouMessage.style.display = 'block'; // Scroll to thank you message thankYouMessage.scrollIntoView({ behavior: 'smooth', block: 'center' }); } catch (error) { console.error('Error submitting form:', error); alert('送信中にエラーが発生しました。しばらくしてから再度お試しください。'); } }); } }); // =========================== // Dev Mode Warning // =========================== // Check if Google Form is configured if (GOOGLE_FORM_CONFIG.formActionUrl === 'YOUR_GOOGLE_FORM_ACTION_URL') { console.warn('⚠️ Googleフォームの設定が必要です。script.jsのGOOGLE_FORM_CONFIGを更新してください。'); }
